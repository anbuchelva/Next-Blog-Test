<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Hugo 0.71.1 with theme Tranquilpeak 0.4.7-BETA"><meta name=author content="Anbuselvan Palaniyandi"><meta name=keywords content="Hyperion Planning,Classic Planning,Forms,Validation Rules"><meta name=description content="I recently encountered with a requirement that the users should input data in the Planning Forms only for Valid Intersection. There&rsquo;s an option to setup Valid Intersection in PBCS. But, the requirement is to setup the same on premises environment.
You ask me how to do it in Microsoft Excel using VBA or Microsoft Access using SQL Query, I would do it very easily. But in Hyperion Planning, there&rsquo;s no such option available inbuilt."><meta property="og:description" content="I recently encountered with a requirement that the users should input data in the Planning Forms only for Valid Intersection. There&rsquo;s an option to setup Valid Intersection in PBCS. But, the requirement is to setup the same on premises environment.
You ask me how to do it in Microsoft Excel using VBA or Microsoft Access using SQL Query, I would do it very easily. But in Hyperion Planning, there&rsquo;s no such option available inbuilt."><meta property="og:type" content="article"><meta property="og:title" content="Valid Intersections in Hyperion Planning"><meta name=twitter:title content="Valid Intersections in Hyperion Planning"><meta property="og:url" content="https://blog.anbuchelva.in/hyperion/valid-intersections-in-hyperion-planning/"><meta property="twitter:url" content="https://blog.anbuchelva.in/hyperion/valid-intersections-in-hyperion-planning/"><meta property="og:site_name" content="anbuchelva's blog"><meta property="og:description" content="I recently encountered with a requirement that the users should input data in the Planning Forms only for Valid Intersection. There&rsquo;s an option to setup Valid Intersection in PBCS. But, the requirement is to setup the same on premises environment.
You ask me how to do it in Microsoft Excel using VBA or Microsoft Access using SQL Query, I would do it very easily. But in Hyperion Planning, there&rsquo;s no such option available inbuilt."><meta name=twitter:description content="I recently encountered with a requirement that the users should input data in the Planning Forms only for Valid Intersection. There&rsquo;s an option to setup Valid Intersection in PBCS. But, the requirement is to setup the same on premises environment.
You ask me how to do it in Microsoft Excel using VBA or Microsoft Access using SQL Query, I would do it very easily. But in Hyperion Planning, there&rsquo;s no such option available inbuilt."><meta property="og:locale" content="en-us"><meta property="article:published_time" content="2018-06-03T10:52:36"><meta property="article:modified_time" content="2018-06-03T10:52:36"><meta property="article:section" content="Hyperion"><meta property="article:tag" content="hyperion planning"><meta property="article:tag" content="classic planning"><meta property="article:tag" content="forms"><meta property="article:tag" content="validation rules"><meta name=twitter:card content="summary"><meta name=twitter:site content="@anbuchelva"><meta name=twitter:creator content="@anbuchelva"><meta property="og:image" content="https://res.cloudinary.com/anbuchelva/image/upload/v1570369637/images/anbuchelva/anbuchelva.jpg"><meta property="twitter:image" content="https://res.cloudinary.com/anbuchelva/image/upload/v1570369637/images/anbuchelva/anbuchelva.jpg"><title>Valid Intersections in Hyperion Planning</title><link rel=icon href=https://res.cloudinary.com/anbuchelva/image/upload/v1579198341/images/anbuchelva/favicon.ico><link rel=canonical href=https://blog.anbuchelva.in/hyperion/valid-intersections-in-hyperion-planning/><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/jquery.fancybox.min.css integrity="sha256-vuXZ9LGmmwtjqFX1F+EKin1ThZMub58gKULUyf0qECk=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/helpers/jquery.fancybox-thumbs.min.css integrity="sha256-SEa4XYAHihTcEP1f5gARTB2K26Uk8PsndQYHQC1f4jU=" crossorigin=anonymous><link rel=stylesheet href=https://blog.anbuchelva.in/css/style-xa7e00u5yklcvn7ko4btqdgzjaffpbx1s5jtajwbxxlaaekvic4ik85cjpmx.min.css><link rel=stylesheet href=https://blog.anbuchelva.in/css/my-custom.css><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-120979997-1','auto');ga('send','pageview');}</script><meta http-equiv=content-security-policy content="upgrade-insecure-requests"></head><body><div id=blog><header id=header data-behavior=5><i id=btn-open-sidebar class="fa fa-lg fa-bars"></i><div class=header-title><a class=header-title-link href=https://blog.anbuchelva.in/>anbuchelva's blog</a></div><a class=header-right-picture href=https://blog.anbuchelva.in/><img class=header-picture src=https://res.cloudinary.com/anbuchelva/image/upload/v1570369637/images/anbuchelva/anbuchelva.jpg alt="Author's picture"></a></header><nav id=sidebar data-behavior=5><div class=sidebar-container><div class=sidebar-profile><a class=sidebar-image-link href=https://blog.anbuchelva.in/index.html><img class=sidebar-profile-picture src=https://res.cloudinary.com/anbuchelva/image/upload/v1570369637/images/anbuchelva/anbuchelva.jpg alt="Author's picture"></a><h4 class=sidebar-profile-name>Anbuselvan Palaniyandi</h4><h5 class=sidebar-profile-bio>an EPM Consultant and an Android Enthusiast</h5></div><ul class=sidebar-buttons><li class=sidebar-button><a class=sidebar-button-link href=https://blog.anbuchelva.in/><i class="sidebar-button-icon fa fa-lg fa-home"></i><span class=sidebar-button-desc>Home</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=https://blog.anbuchelva.in/categories><i class="sidebar-button-icon fa fa-lg fa-bookmark"></i><span class=sidebar-button-desc>Categories</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=https://blog.anbuchelva.in/tags><i class="sidebar-button-icon fa fa-lg fa-tags"></i><span class=sidebar-button-desc>Tags</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=https://blog.anbuchelva.in/archives><i class="sidebar-button-icon fa fa-lg fa-archive"></i><span class=sidebar-button-desc>Archives</span></a></li></ul><ul class=sidebar-buttons><li class=sidebar-button><a class=sidebar-button-link href=mailto:anbu@essbase.dev target=_blank rel=noopener><i class="sidebar-button-icon fa fa-lg fa-envelope"></i><span class=sidebar-button-desc>Contact</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=https://in.linkedin.com/in/anbuchelva target=_blank rel=noopener><i class="sidebar-button-icon fa fa-lg fa-linkedin"></i><span class=sidebar-button-desc>LinkedIN</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=https://twitter.com/anbuchelva target=_blank rel=noopener><i class="sidebar-button-icon fa fa-lg fa-twitter"></i><span class=sidebar-button-desc>Twitter</span></a></li></ul><ul class=sidebar-buttons><li class=sidebar-button><a class=sidebar-button-link href=https://blog.anbuchelva.in/index.xml><i class="sidebar-button-icon fa fa-lg fa-rss"></i><span class=sidebar-button-desc>RSS</span></a></li></ul></div></nav><div id=main data-behavior=5 class=hasCoverMetaIn><article class=post itemscope itemtype=http://schema.org/BlogPosting><div class="post-header main-content-wrap text-left"><h1 class=post-title itemprop=headline>Valid Intersections in Hyperion Planning</h1><div class="postShorten-meta post-meta"><time itemprop=datePublished datetime=2018-06-03T10:52:36Z>June 3, 2018</time>
<span>in</span>
<a class=category-link href=https://blog.anbuchelva.in/categories/hyperion>Hyperion</a></div></div><div class="post-content markdown" itemprop=articleBody><div class=main-content-wrap><p>I recently encountered with a requirement that the users should input data in the Planning Forms only for Valid Intersection. There&rsquo;s an option to setup Valid Intersection in PBCS. But, the requirement is to setup the same on premises environment.
You ask me how to do it in Microsoft Excel using VBA or Microsoft Access using SQL Query, I would do it very easily. But in Hyperion Planning, there&rsquo;s no such option available inbuilt.</p><h3 id=the-problem>The Problem</h3><p>There are two dimensions in a classic Planning Application having <em>many to many</em> relationship. The user should select the correct combination in the web forms/SmartView and input the data. There should be restrictions setup for selecting/updating in incorrect combinations.
Lets assume the application is having following dimensions.</p><ol><li>Year</li><li>Period</li><li>Scenario</li><li>Version</li><li>Currency</li><li>Entity</li><li>Operating Unit</li><li>Business Unit</li></ol><p>Here the Operating Unit and the Business Unit are the problem area.</p><h3 id=possible-solution>Possible Solution</h3><p>Restrict user access for only the Valid Intersection. But it will overlap and create mess, if the user has access to more than one Valid Intersection.</p><h3 id=solution>Solution</h3><h4 id=step-1-create-2-account-members>Step 1: Create 2 Account members</h4><ul><li>Create an Account member named <em>Valid Intersection</em> and set the member property to refer Yes/No Smart list Value</li><li>Create a dynamic calc member and add this formula <code>["Current Year"] -> "BegBalance" -> ["Current Scenario"] -> ["Current Version"] -> ["Currency where the inputs to be made"] -> "No Entity"</code></li></ul><div class="alert info"><p>the brackets to be removed after updating the correct members.</p></div><h4 id=step-2-setup-web-form-to-collect-the-right-intersections>Step 2: Setup web form to collect the right intersections.</h4><p>Setup a web from by selecting the above mentioned members in the POV section and the Operating Unit / Business Unit in Rows/Columns. Account should be &ldquo;Valid Intersection&rdquo;, which we created in step 1.
The form should be available as below:
<strong>POV / Page</strong> : <code>FY18 -> BegBalance -> Current -> Working -> Local -> No Entity</code></p><table><thead><tr><th></th><th align=center>BU1</th><th align=center>BU2</th><th align=center>BU3</th><th align=center>BUn</th></tr></thead><tbody><tr><td>OU1</td><td align=center>Yes</td><td align=center></td><td align=center></td><td align=center></td></tr><tr><td>OU2</td><td align=center>Yes</td><td align=center></td><td align=center></td><td align=center></td></tr><tr><td>OU3</td><td align=center></td><td align=center>Yes</td><td align=center></td><td align=center></td></tr><tr><td>OU4</td><td align=center></td><td align=center></td><td align=center>Yes</td><td align=center></td></tr></tbody></table><p>The <code>dyn_Valid Intersection</code> member would give an output as 0 or 1 (yes or no) for these BU / OU irrespective of selections in the other dimensions.</p><h4 id=step-3-include-the-dyn_valid-intersection-member-in-the-forms-and-setup-validation-rules>Step 3: Include the <code>dyn_Valid Intersection</code> member in the forms and setup validation rules.</h4><p>Open the form in <code>Edit</code> mode and go to <code>Layout</code> tab.</p><ol><li>Add the <code>dyn_Valid Intersection</code> member in the first row of every form, where you want to set up this validation. <em>I&rsquo;m trying to find a way to achieve the output without adding a row</em></li><li>Select <code>Validation Rules</code> from right pane, click the <code>+</code> sign and setup a validation rule as like the screen shot<br><img src=https://res.cloudinary.com/anbuchelva/image/upload/f_auto,q_auto/v1546629694/images/HP/Validation_Rule1.PNG alt="Hyperion Planning Form Validation Rule Setup"></li><li>I keep the process format in grey, as it would mimic the user that the cell is locked for editing, though it is editable. You may add a <code>Validation Message</code> which will be displayed to the users upon error.<br><img src=https://res.cloudinary.com/anbuchelva/image/upload/f_auto,q_auto/v1546629694/images/HP/Validation_Rule2.PNG alt="Hyperion Planning Form Validation Error Message"></li><li>Once done, click <code>Validate</code> to validate the <code>Validation Rule</code> 😉<br><img src=https://res.cloudinary.com/anbuchelva/image/upload/f_auto,q_auto/v1546629694/images/HP/Validation_Rule3.PNG alt="Hyperion Planning Form Validate validation rule"></li><li>Now open the form to input data and select incorrect combination from the <code>Page</code> section / <code>drop down</code>. You will see all the cells are grayed out. When you try to input data in a <code>store</code> member, you will get the error message that was setup in the <code>Validation Rule</code>.<br><img src=https://res.cloudinary.com/anbuchelva/image/upload/f_auto,q_auto/v1546629694/images/HP/Validation_Rule4.PNG alt="Hyperion Planning Validation Rule Invalid Intersections"></li><li>It doesn&rsquo;t restrict user to input on the invalid intersections. However, it just give a warning to them that they have selected invalid intersections and inputting data.</li></ol><h4 id=step-4-setup-a-business-rule-to-validate-the-intersections-while-saving-form>Step 4: Setup a Business rule to validate the intersections while saving form.</h4><p>As an additional way to restrict processing calculations for the invalid intersections, we can setup a Business Rule and place it in the first position with <code>@Return</code> message.
sample code is given below:</p><pre><code>FIX(&quot;FY18&quot;,{RTP_BU},{RTP_OU})
	&quot;Valid Intersection&quot;(
	IF(&quot;dyn_Valid Intersection&quot; &lt;&gt; 1))
		@RETURN(&quot;Invalid BU x OU selected, pls select the valid BU x OU&quot;, Error);
	ENDIF)
ENDFIX
</code></pre><div class="alert info"><p>All these checks would work only for form. There&rsquo;s no way to restrict, if an user prefer to load data through ad-hoc smartview query or try loading through back end.</p></div><h3 id=conclusion>Conclusion</h3><p>This would be very easy (Step 3 is not needed), if Oracle provides an option to run a Business Rule while loading the form with <code>Run Time Prompt</code>. It is not supported and we need to do all these steps as workaround.</p></div></div><div id=post-footer class="post-footer main-content-wrap"><div class=post-footer-tags><span class="text-color-light text-small">TAGGED IN</span><br><a class="tag tag--primary tag--small" href=https://blog.anbuchelva.in/tags/hyperion-planning/>hyperion planning</a>
<a class="tag tag--primary tag--small" href=https://blog.anbuchelva.in/tags/classic-planning/>classic planning</a>
<a class="tag tag--primary tag--small" href=https://blog.anbuchelva.in/tags/forms/>forms</a>
<a class="tag tag--primary tag--small" href=https://blog.anbuchelva.in/tags/validation-rules/>validation rules</a></div><div class=post-actions-wrap><nav><ul class="post-actions post-action-nav"><li class=post-action><a class="post-action-btn btn btn--default tooltip--top" href=https://blog.anbuchelva.in/blog/blogging-in-the-hard-way/ data-tooltip="Blogging in the Hard Way"><i class="fa fa-angle-left"></i><span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span></a></li><li class=post-action><a class="post-action-btn btn btn--default tooltip--top" href=https://blog.anbuchelva.in/hyperion/common-connection-name-in-smartview-functions/ data-tooltip="Common Connection Name in Smartview Functions"><span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
<i class="fa fa-angle-right"></i></a></li></ul></nav><ul class="post-actions post-action-share"><li class="post-action hide-lg hide-md hide-sm"><a class="post-action-btn btn btn--default btn-open-shareoptions" href=#btn-open-shareoptions><i class="fa fa-share-alt"></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://www.facebook.com/sharer/sharer.php?u=https://blog.anbuchelva.in/hyperion/valid-intersections-in-hyperion-planning/"><i class="fa fa-facebook-official"></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://twitter.com/intent/tweet?text=https://blog.anbuchelva.in/hyperion/valid-intersections-in-hyperion-planning/"><i class="fa fa-twitter"></i></a></li><li class=post-action><a class="post-action-btn btn btn--default" href=#disqus_thread><i class="fa fa-comment-o"></i></a></li><li class=post-action><a class="post-action-btn btn btn--default" href=#><i class="fa fa-list"></i></a></li></ul></div><div id=disqus_thread><noscript>Please enable JavaScript to view the <a href=//disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div></div></article><footer id=footer class=main-content-wrap><span class=copyrights>&copy; 2020 <a href=https://github.com/anbuchelva>anbuchelva</a>. All Rights Reserved</span></footer></div><div id=bottom-bar class=post-bottom-bar data-behavior=5><div class=post-actions-wrap><nav><ul class="post-actions post-action-nav"><li class=post-action><a class="post-action-btn btn btn--default tooltip--top" href=https://blog.anbuchelva.in/blog/blogging-in-the-hard-way/ data-tooltip="Blogging in the Hard Way"><i class="fa fa-angle-left"></i><span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span></a></li><li class=post-action><a class="post-action-btn btn btn--default tooltip--top" href=https://blog.anbuchelva.in/hyperion/common-connection-name-in-smartview-functions/ data-tooltip="Common Connection Name in Smartview Functions"><span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
<i class="fa fa-angle-right"></i></a></li></ul></nav><ul class="post-actions post-action-share"><li class="post-action hide-lg hide-md hide-sm"><a class="post-action-btn btn btn--default btn-open-shareoptions" href=#btn-open-shareoptions><i class="fa fa-share-alt"></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://www.facebook.com/sharer/sharer.php?u=https://blog.anbuchelva.in/hyperion/valid-intersections-in-hyperion-planning/"><i class="fa fa-facebook-official"></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://twitter.com/intent/tweet?text=https://blog.anbuchelva.in/hyperion/valid-intersections-in-hyperion-planning/"><i class="fa fa-twitter"></i></a></li><li class=post-action><a class="post-action-btn btn btn--default" href=#disqus_thread><i class="fa fa-comment-o"></i></a></li><li class=post-action><a class="post-action-btn btn btn--default" href=#><i class="fa fa-list"></i></a></li></ul></div></div><div id=share-options-bar class=share-options-bar data-behavior=5><i id=btn-close-shareoptions class="fa fa-close"></i><ul class=share-options><li class=share-option><a class=share-option-btn target=new href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fblog.anbuchelva.in%2Fhyperion%2Fvalid-intersections-in-hyperion-planning%2F"><i class="fa fa-facebook-official"></i><span>Share on Facebook</span></a></li><li class=share-option><a class=share-option-btn target=new href="https://twitter.com/intent/tweet?text=https%3A%2F%2Fblog.anbuchelva.in%2Fhyperion%2Fvalid-intersections-in-hyperion-planning%2F"><i class="fa fa-twitter"></i><span>Share on Twitter</span></a></li></ul></div><div id=share-options-mask class=share-options-mask></div></div><div id=about><div id=about-card><div id=about-btn-close><i class="fa fa-remove"></i></div><img id=about-card-picture src=https://res.cloudinary.com/anbuchelva/image/upload/v1570369637/images/anbuchelva/anbuchelva.jpg alt="Author's picture"><h4 id=about-card-name>Anbuselvan Palaniyandi</h4><div id=about-card-bio>an EPM Consultant and an Android Enthusiast</div><div id=about-card-job><i class="fa fa-briefcase"></i><br>Manager @ Standard Chartered Bank</div><div id=about-card-location><i class="fa fa-map-marker"></i><br>Chennai, India</div></div></div><div id=cover style=background-image:url(https://blog.anbuchelva.in/images/background.webp)></div><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.7/js/jquery.fancybox.min.js integrity="sha256-GEAnjcTqVP+vBp3SSc8bEDQqvWAZMiHyUSIorrWwH50=" crossorigin=anonymous></script><script src=https://blog.anbuchelva.in/js/script-jsilukuq7qljiaqnipbvkargfvxhraehx3amgxyfsgc01s5k6dkdbmt8dc.min.js></script><script lang=javascript>window.onload=updateMinWidth;window.onresize=updateMinWidth;document.getElementById("sidebar").addEventListener("transitionend",updateMinWidth);function updateMinWidth(){var sidebar=document.getElementById("sidebar");var main=document.getElementById("main");main.style.minWidth="";var w1=getComputedStyle(main).getPropertyValue("min-width");var w2=getComputedStyle(sidebar).getPropertyValue("width");var w3=getComputedStyle(sidebar).getPropertyValue("left");main.style.minWidth=`calc(${w1} - ${w2} - ${w3})`;}</script><script>$(document).ready(function(){hljs.configure({classPrefix:'',useBR:false});$('pre.code-highlight > code, pre > code').each(function(i,block){if(!$(this).hasClass('codeblock')){$(this).addClass('codeblock');}
hljs.highlightBlock(block);});});</script><script>var disqus_config=function(){this.page.url='https:\/\/blog.anbuchelva.in\/hyperion\/valid-intersections-in-hyperion-planning\/';this.page.identifier='\/hyperion\/valid-intersections-in-hyperion-planning\/'};$(function(){showDisqus=function(){if(window.location.hostname=="localhost"){return;}
var disqus_shortname='anbu-blog';(function(){var disqus=document.createElement('script');disqus.type='text/javascript';disqus.async=true;disqus.src='//'+disqus_shortname+'.disqus.com/embed.js';(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(disqus);})();};$('#show-comments').on('click',showDisqus);$('#show-comments-2').on('click',showDisqus);});</script></body></html>